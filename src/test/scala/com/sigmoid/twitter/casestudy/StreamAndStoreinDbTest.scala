package com.sigmoid.twitter.casestudy

import org.junit.Test
import org.mongodb.scala.MongoClient

class StreamAndStoreinDbTest {
  @Test
  def test_format_tweets_for_invalid_country(){

    val tweet_dataline="{ \n  \"created_at\" : \"Fri Apr 03 08:01:03 +0000 2020\", \n    \"id\" : 1245984646170652672, \n    \"id_str\" : \"1245984646170652672\", \n    \"text\" : \"Reportan más de un millón de contagiados por el nuevo coronavirus en el mundo https://t.co/2c8ByaKAu4\", \n    \"source\" : \"<a href=\\\"https://ifttt.com\\\" rel=\\\"nofollow\\\">IFTTT</a>\", \n    \"truncated\" : false, \n    \"in_reply_to_status_id\" : null, \n    \"in_reply_to_status_id_str\" : null, \n    \"in_reply_to_user_id\" : null, \n    \"in_reply_to_user_id_str\" : null, \n    \"in_reply_to_screen_name\" : null, \n    \"user\" : {\n        \"id\" : 885342474, \n        \"id_str\" : \"885342474\", \n        \"name\" : \"INTERNACIONAL\", \n        \"screen_name\" : \"informador_INT\", \n        \"location\" : \"Guadalajara\", \n        \"url\" : \"http://www.informador.mx/internacional/\", \n        \"description\" : \"Noticias más recientes del acontecer en América Latina, Europa, Asia, Medio Oriente y África  ::: Siempre una buena noticia ::: Una cuenta de @informador.\", \n        \"translator_type\" : \"none\", \n        \"protected\" : false, \n        \"verified\" : false, \n        \"followers_count\" : 10524, \n        \"friends_count\" : 103, \n        \"listed_count\" : 144, \n        \"favourites_count\" : 48, \n        \"statuses_count\" : 92597, \n        \"created_at\" : \"Tue Oct 16 21:25:33 +0000 2012\", \n        \"utc_offset\" : null, \n        \"time_zone\" : null, \n        \"geo_enabled\" : false, \n        \"lang\" : null, \n        \"contributors_enabled\" : false, \n        \"is_translator\" : false, \n        \"profile_background_color\" : \"131516\", \n        \"profile_background_image_url\" : \"http://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_image_url_https\" : \"https://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_tile\" : true, \n        \"profile_link_color\" : \"3675C2\", \n        \"profile_sidebar_border_color\" : \"000000\", \n        \"profile_sidebar_fill_color\" : \"EFEFEF\", \n        \"profile_text_color\" : \"333333\", \n        \"profile_use_background_image\" : true, \n        \"profile_image_url\" : \"http://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_image_url_https\" : \"https://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_banner_url\" : \"https://pbs.twimg.com/profile_banners/885342474/1516828871\", \n        \"default_profile\" : false, \n        \"default_profile_image\" : false, \n        \"following\" : null, \n        \"follow_request_sent\" : null, \n        \"notifications\" : null\n    }, \n    \"geo\" : null, \n    \"coordinates\" : null, \n    \"place\" : null, \n    \"contributors\" : null, \n    \"is_quote_status\" : false, \n    \"quote_count\" : 0, \n    \"reply_count\" : 0, \n    \"retweet_count\" : 0, \n    \"favorite_count\" : 0, \n    \"entities\" : {\n        \"hashtags\" : [\n\n        ], \n        \"urls\" : [\n            {\n                \"url\" : \"https://t.co/2c8ByaKAu4\", \n                \"expanded_url\" : \"https://ift.tt/2UEPy4L\", \n                \"display_url\" : \"ift.tt/2UEPy4L\", \n                \"indices\" : [\n                    78, \n                    101\n                ]\n            }\n        ], \n        \"user_mentions\" : [\n\n        ], \n        \"symbols\" : [\n\n        ]\n    }, \n    \"favorited\" : false, \n    \"retweeted\" : false, \n    \"possibly_sensitive\" : false, \n    \"filter_level\" : \"low\", \n    \"lang\" : \"es\", \n    \"timestamp_ms\" : \"1585900863579\"\n}"
    val predicted_output=null

    assert(predicted_output==StreamAndStoreInDb.formatTweets(tweet_dataline)._2)
  }


  @Test
  def test_format_tweets_for_valid_country(){

    val tweet_dataline="{ \n  \"created_at\" : \"Fri Apr 03 08:01:03 +0000 2020\", \n    \"id\" : 1245984646170652672, \n    \"id_str\" : \"1245984646170652672\", \n    \"text\" : \"Reportan más de un millón de contagiados por el nuevo coronavirus en el mundo https://t.co/2c8ByaKAu4\", \n    \"source\" : \"<a href=\\\"https://ifttt.com\\\" rel=\\\"nofollow\\\">IFTTT</a>\", \n    \"truncated\" : false, \n    \"in_reply_to_status_id\" : null, \n    \"in_reply_to_status_id_str\" : null, \n    \"in_reply_to_user_id\" : null, \n    \"in_reply_to_user_id_str\" : null, \n    \"in_reply_to_screen_name\" : null, \n    \"user\" : {\n        \"id\" : 885342474, \n        \"id_str\" : \"885342474\", \n        \"name\" : \"INTERNACIONAL\", \n        \"screen_name\" : \"informador_INT\", \n        \"location\" : \"India\", \n        \"url\" : \"http://www.informador.mx/internacional/\", \n        \"description\" : \"Noticias más recientes del acontecer en América Latina, Europa, Asia, Medio Oriente y África  ::: Siempre una buena noticia ::: Una cuenta de @informador.\", \n        \"translator_type\" : \"none\", \n        \"protected\" : false, \n        \"verified\" : false, \n        \"followers_count\" : 10524, \n        \"friends_count\" : 103, \n        \"listed_count\" : 144, \n        \"favourites_count\" : 48, \n        \"statuses_count\" : 92597, \n        \"created_at\" : \"Tue Oct 16 21:25:33 +0000 2012\", \n        \"utc_offset\" : null, \n        \"time_zone\" : null, \n        \"geo_enabled\" : false, \n        \"lang\" : null, \n        \"contributors_enabled\" : false, \n        \"is_translator\" : false, \n        \"profile_background_color\" : \"131516\", \n        \"profile_background_image_url\" : \"http://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_image_url_https\" : \"https://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_tile\" : true, \n        \"profile_link_color\" : \"3675C2\", \n        \"profile_sidebar_border_color\" : \"000000\", \n        \"profile_sidebar_fill_color\" : \"EFEFEF\", \n        \"profile_text_color\" : \"333333\", \n        \"profile_use_background_image\" : true, \n        \"profile_image_url\" : \"http://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_image_url_https\" : \"https://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_banner_url\" : \"https://pbs.twimg.com/profile_banners/885342474/1516828871\", \n        \"default_profile\" : false, \n        \"default_profile_image\" : false, \n        \"following\" : null, \n        \"follow_request_sent\" : null, \n        \"notifications\" : null\n    }, \n    \"geo\" : null, \n    \"coordinates\" : null, \n    \"place\" : null, \n    \"contributors\" : null, \n    \"is_quote_status\" : false, \n    \"quote_count\" : 0, \n    \"reply_count\" : 0, \n    \"retweet_count\" : 0, \n    \"favorite_count\" : 0, \n    \"entities\" : {\n        \"hashtags\" : [\n\n        ], \n        \"urls\" : [\n            {\n                \"url\" : \"https://t.co/2c8ByaKAu4\", \n                \"expanded_url\" : \"https://ift.tt/2UEPy4L\", \n                \"display_url\" : \"ift.tt/2UEPy4L\", \n                \"indices\" : [\n                    78, \n                    101\n                ]\n            }\n        ], \n        \"user_mentions\" : [\n\n        ], \n        \"symbols\" : [\n\n        ]\n    }, \n    \"favorited\" : false, \n    \"retweeted\" : false, \n    \"possibly_sensitive\" : false, \n    \"filter_level\" : \"low\", \n    \"lang\" : \"es\", \n    \"timestamp_ms\" : \"1585900863579\"\n}"
    val predicted_output="\"India\""

    assert(predicted_output==StreamAndStoreInDb.formatTweets(tweet_dataline)._2)
  }

  @Test
  def check_for_Mongo_availabilty(){
    val mongoClient: MongoClient = MongoClient()
    assert(mongoClient!=null)
  }


  @Test
  def removal_of_stop_words(){
// text in the tweet is "I love my country"
    val tweet_dataline="{ \n  \"created_at\" : \"Fri Apr 03 08:01:03 +0000 2020\", \n    \"id\" : 1245984646170652672, \n    \"id_str\" : \"1245984646170652672\", \n    \"text\" : \"I love my country\", \n    \"source\" : \"<a href=\\\"https://ifttt.com\\\" rel=\\\"nofollow\\\">IFTTT</a>\", \n    \"truncated\" : false, \n    \"in_reply_to_status_id\" : null, \n    \"in_reply_to_status_id_str\" : null, \n    \"in_reply_to_user_id\" : null, \n    \"in_reply_to_user_id_str\" : null, \n    \"in_reply_to_screen_name\" : null, \n    \"user\" : {\n        \"id\" : 885342474, \n        \"id_str\" : \"885342474\", \n        \"name\" : \"INTERNACIONAL\", \n        \"screen_name\" : \"informador_INT\", \n        \"location\" : \"India\", \n        \"url\" : \"http://www.informador.mx/internacional/\", \n        \"description\" : \"Noticias más recientes del acontecer en América Latina, Europa, Asia, Medio Oriente y África  ::: Siempre una buena noticia ::: Una cuenta de @informador.\", \n        \"translator_type\" : \"none\", \n        \"protected\" : false, \n        \"verified\" : false, \n        \"followers_count\" : 10524, \n        \"friends_count\" : 103, \n        \"listed_count\" : 144, \n        \"favourites_count\" : 48, \n        \"statuses_count\" : 92597, \n        \"created_at\" : \"Tue Oct 16 21:25:33 +0000 2012\", \n        \"utc_offset\" : null, \n        \"time_zone\" : null, \n        \"geo_enabled\" : false, \n        \"lang\" : null, \n        \"contributors_enabled\" : false, \n        \"is_translator\" : false, \n        \"profile_background_color\" : \"131516\", \n        \"profile_background_image_url\" : \"http://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_image_url_https\" : \"https://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_tile\" : true, \n        \"profile_link_color\" : \"3675C2\", \n        \"profile_sidebar_border_color\" : \"000000\", \n        \"profile_sidebar_fill_color\" : \"EFEFEF\", \n        \"profile_text_color\" : \"333333\", \n        \"profile_use_background_image\" : true, \n        \"profile_image_url\" : \"http://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_image_url_https\" : \"https://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_banner_url\" : \"https://pbs.twimg.com/profile_banners/885342474/1516828871\", \n        \"default_profile\" : false, \n        \"default_profile_image\" : false, \n        \"following\" : null, \n        \"follow_request_sent\" : null, \n        \"notifications\" : null\n    }, \n    \"geo\" : null, \n    \"coordinates\" : null, \n    \"place\" : null, \n    \"contributors\" : null, \n    \"is_quote_status\" : false, \n    \"quote_count\" : 0, \n    \"reply_count\" : 0, \n    \"retweet_count\" : 0, \n    \"favorite_count\" : 0, \n    \"entities\" : {\n        \"hashtags\" : [\n\n        ], \n        \"urls\" : [\n            {\n                \"url\" : \"https://t.co/2c8ByaKAu4\", \n                \"expanded_url\" : \"https://ift.tt/2UEPy4L\", \n                \"display_url\" : \"ift.tt/2UEPy4L\", \n                \"indices\" : [\n                    78, \n                    101\n                ]\n            }\n        ], \n        \"user_mentions\" : [\n\n        ], \n        \"symbols\" : [\n\n        ]\n    }, \n    \"favorited\" : false, \n    \"retweeted\" : false, \n    \"possibly_sensitive\" : false, \n    \"filter_level\" : \"low\", \n    \"lang\" : \"es\", \n    \"timestamp_ms\" : \"1585900863579\"\n}"
    val predicted_output= "\"" +"love country"+ "\""
    assert(predicted_output==StreamAndStoreInDb.formatTweets(tweet_dataline)._3)
  }


  @Test
  def date_format(){
    // date in the tweet is "Fri Apr 03 08:01:03 +0000 2020"
    val tweet_dataline="{ \n  \"created_at\" : \"Fri Apr 03 08:01:03 +0000 2020\", \n    \"id\" : 1245984646170652672, \n    \"id_str\" : \"1245984646170652672\", \n    \"text\" : \"I love my country\", \n    \"source\" : \"<a href=\\\"https://ifttt.com\\\" rel=\\\"nofollow\\\">IFTTT</a>\", \n    \"truncated\" : false, \n    \"in_reply_to_status_id\" : null, \n    \"in_reply_to_status_id_str\" : null, \n    \"in_reply_to_user_id\" : null, \n    \"in_reply_to_user_id_str\" : null, \n    \"in_reply_to_screen_name\" : null, \n    \"user\" : {\n        \"id\" : 885342474, \n        \"id_str\" : \"885342474\", \n        \"name\" : \"INTERNACIONAL\", \n        \"screen_name\" : \"informador_INT\", \n        \"location\" : \"India\", \n        \"url\" : \"http://www.informador.mx/internacional/\", \n        \"description\" : \"Noticias más recientes del acontecer en América Latina, Europa, Asia, Medio Oriente y África  ::: Siempre una buena noticia ::: Una cuenta de @informador.\", \n        \"translator_type\" : \"none\", \n        \"protected\" : false, \n        \"verified\" : false, \n        \"followers_count\" : 10524, \n        \"friends_count\" : 103, \n        \"listed_count\" : 144, \n        \"favourites_count\" : 48, \n        \"statuses_count\" : 92597, \n        \"created_at\" : \"Tue Oct 16 21:25:33 +0000 2012\", \n        \"utc_offset\" : null, \n        \"time_zone\" : null, \n        \"geo_enabled\" : false, \n        \"lang\" : null, \n        \"contributors_enabled\" : false, \n        \"is_translator\" : false, \n        \"profile_background_color\" : \"131516\", \n        \"profile_background_image_url\" : \"http://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_image_url_https\" : \"https://abs.twimg.com/images/themes/theme14/bg.gif\", \n        \"profile_background_tile\" : true, \n        \"profile_link_color\" : \"3675C2\", \n        \"profile_sidebar_border_color\" : \"000000\", \n        \"profile_sidebar_fill_color\" : \"EFEFEF\", \n        \"profile_text_color\" : \"333333\", \n        \"profile_use_background_image\" : true, \n        \"profile_image_url\" : \"http://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_image_url_https\" : \"https://pbs.twimg.com/profile_images/912734965791563776/M4uS7DRm_normal.jpg\", \n        \"profile_banner_url\" : \"https://pbs.twimg.com/profile_banners/885342474/1516828871\", \n        \"default_profile\" : false, \n        \"default_profile_image\" : false, \n        \"following\" : null, \n        \"follow_request_sent\" : null, \n        \"notifications\" : null\n    }, \n    \"geo\" : null, \n    \"coordinates\" : null, \n    \"place\" : null, \n    \"contributors\" : null, \n    \"is_quote_status\" : false, \n    \"quote_count\" : 0, \n    \"reply_count\" : 0, \n    \"retweet_count\" : 0, \n    \"favorite_count\" : 0, \n    \"entities\" : {\n        \"hashtags\" : [\n\n        ], \n        \"urls\" : [\n            {\n                \"url\" : \"https://t.co/2c8ByaKAu4\", \n                \"expanded_url\" : \"https://ift.tt/2UEPy4L\", \n                \"display_url\" : \"ift.tt/2UEPy4L\", \n                \"indices\" : [\n                    78, \n                    101\n                ]\n            }\n        ], \n        \"user_mentions\" : [\n\n        ], \n        \"symbols\" : [\n\n        ]\n    }, \n    \"favorited\" : false, \n    \"retweeted\" : false, \n    \"possibly_sensitive\" : false, \n    \"filter_level\" : \"low\", \n    \"lang\" : \"es\", \n    \"timestamp_ms\" : \"1585900863579\"\n}"
    val predicted_output= "\"" +"Apr 03 2020"+ "\""
    assert(predicted_output==StreamAndStoreInDb.formatTweets(tweet_dataline)._1)
  }
}
